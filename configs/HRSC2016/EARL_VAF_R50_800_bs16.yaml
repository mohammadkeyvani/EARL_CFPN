_BASE_: "./Base_RFCOS_EARL_R50.yaml"

MODEL:
  WEIGHTS: "catalog://ImageNetPretrained/FAIR/R-50-GN"

  RESNETS:
    STRIDE_IN_1X1: False
    NORM: "GN"

  FPN:
    NORM: "GN"

  RFCOS:
    NUM_CLASSES: 1
    NORM: "GN"

    TOPK_SAMPLE: 16          # ฺฉุงูุด ูุตุฑู VRAM
    ANGLE_RANGE: "a180"

    NMS_THRESH_TEST: 0.5
    SCORE_THRESH_TEST: 0.01

    BBOX_REG_LOSS_TYPE: "smooth_l1_weight"

DATASETS:
  TRAIN: ("hrsc_trainval", )
  TEST: ("hrsc_test",)

DATALOADER:
  FILTER_EMPTY_ANNOTATIONS: False
  NUM_WORKERS: 4             # Kaggle ูพุงุฏุงุฑุชุฑ ุงุฒ 8

INPUT:
  MIN_SIZE_TRAIN: (600, 800, 1000)
  MIN_SIZE_TEST: 800

  MAX_SIZE_TRAIN: 1333       # ููุฏุงุฑ ุงุณุชุงูุฏุงุฑุฏ ู ุงูู
  MAX_SIZE_TEST: 1333

SOLVER:
  IMS_PER_BATCH: 2            # ุงูู ุจุฑุง T4
  BASE_LR: 0.0025             # ููุงุณุจ batch=2

  MAX_ITER: 36000             # HRSC ุฒูุฏุชุฑ converge ูโฺฉูุฏ
  STEPS: (24000, 30000)

  WARMUP_ITERS: 1000

  AMP:
    ENABLED: True             # ๐ฅ ุฎู ููู ุจุฑุง T4

TEST:
  EVAL_PERIOD: 2000           # ฺฉุงูุด overhead

OUTPUT_DIR: "./work_dir/HRSC2016/EARL_VAF_R50_800_T4"
